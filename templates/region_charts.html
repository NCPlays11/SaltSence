{% extends 'base.html' %}
{% block title %}Charts for {{ region }} {% endblock %}
{% block content %}
<style>
    #chartsContainer {
        display: flex;
        flex-direction: column; /* Makes items stack vertically */
        gap: 20px;
        padding: 20px;
        max-width: 800px; /* Optimized for laptop screen */
        margin: 0 auto;
    }

    canvas {
        background: white;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        padding: 10px;
        max-width: 100%; /* Makes charts responsive */
    }

   
</style>

<body>
     <div class="container my-4">
    <h1 class="text-center mb-4">Charts for {{ region }}</h1>
    <div id="chartsContainer">
        {% for variable in ["Desalinated_Water_Produced_Million_m3", "Energy_Consumption_kWh_per_m3", "Brine_Discharge_Million_m3", "Marine_Impact_Index", "Cost_USD_per_m3"] %}
            <canvas id="{{ variable }}" width="400" height="400"></canvas>
        {% endfor %}
    </div>
     </div>
    <script>
        const data = {{ data|tojson|safe }};
        const variables = ["Desalinated_Water_Produced_Million_m3", "Energy_Consumption_kWh_per_m3", "Brine_Discharge_Million_m3", "Marine_Impact_Index", "Cost_USD_per_m3"];
        const labels = data.map(item => item.Year);

        variables.forEach(variable => {
            const ctx = document.getElementById(variable).getContext('2d');
            const chartData = data.map(item => item[variable]);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: variable.replace(/_/g, ' '),
                            data: chartData,
                            borderColor: `rgba(${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, ${Math.floor(Math.random() * 255)}, 1)`,
                            backgroundColor: 'rgba(0, 0, 0, 0.1)',
                            fill: true,
                            tension: 0.4, /* Makes lines smoother */
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: variable.replace(/_/g, ' '),
                            font: {
                                size: 16,
                                weight: 'bold',
                            }
                        },
                        legend: {
                            display: true,
                            labels: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: '#0056b3',
                            titleColor: 'white',
                            bodyColor: 'white'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Year',
                                font: {
                                    size: 14,
                                    weight: 'bold',
                                }
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: variable.replace(/_/g, ' '),
                                font: {
                                    size: 14,
                                    weight: 'bold',
                                }
                            },
                            ticks: {
                                font: {
                                    size: 12
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>    
</body>
{% endblock %}
